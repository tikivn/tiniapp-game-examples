window.__require=function e(t,o,n){function r(i,s){if(!o[i]){if(!t[i]){var c=i.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+i+"'")}i=c}var u=o[i]={exports:{}};t[i][0].call(u.exports,function(e){return r(t[i][1][e]||e)},u,u.exports,e,t,o,n)}return o[i].exports}for(var a="function"==typeof __require&&__require,i=0;i<n.length;i++)r(n[i]);return r}({Admob:[function(e,t,o){"use strict";cc._RF.push(t,"01625mmz41AtZwOlilf3gHd","Admob");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,s=i.ccclass,c=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rewardCallBack=null,t}return r(t,e),t.prototype.onLoad=function(){console.log("admob init"),this.admobInit()},t.prototype.start=function(){},t.prototype.admobInit=function(){if(cc.sys.isMobile){var e=this;sdkbox.PluginAdMob.setListener({adViewDidReceiveAd:function(t){e.showInfo("adViewDidReceiveAd name="+t),"banner"==t&&sdkbox.PluginAdMob.show("banner")},adViewDidFailToReceiveAdWithError:function(t,o){e.showInfo("adViewDidFailToReceiveAdWithError name="+t+" msg="+o)},adViewWillPresentScreen:function(t){e.showInfo("adViewWillPresentScreen name="+t)},adViewDidDismissScreen:function(t){e.showInfo("adViewDidDismissScreen name="+t),"gameover"==t&&sdkbox.PluginAdMob.cache("gameover")},adViewWillDismissScreen:function(t){e.showInfo("adViewWillDismissScreen name="+t)},adViewWillLeaveApplication:function(t){e.showInfo("adViewWillLeaveApplication name="+t)},reward:function(t,o,n){e.showInfo("name: "+t+", currency: "+o+", amount: "+n),e.rewardCallBack&&e.rewardCallBack()}}),sdkbox.PluginAdMob.init(),sdkbox.PluginAdMob.cache("banner"),sdkbox.PluginAdMob.cache("gameover")}},t.prototype.cacheInterstitial=function(){cc.sys.isMobile&&sdkbox.PluginAdMob.cache("interstitial")},t.prototype.showInterstitial=function(){cc.sys.isMobile&&(sdkbox.PluginAdMob.show("interstitial"),this.showInfo("showInterstitial"))},t.prototype.showRewarded=function(e){cc.sys.isMobile&&(sdkbox.PluginAdMob.show("reward"),this.rewardCallBack=e,this.showInfo("rewarded"))},t.prototype.showInfo=function(e){console.log(e)},t.showInterstialAds=function(){var e=cc.find("Canvas").getComponent("Admob");console.log("admob :"+e),e.showInterstitial()},t.showRewarded=function(e){var t=cc.find("Canvas").getComponent("Admob");console.log("admob :"+t),t.showRewarded(e)},a([s],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],AdsManager:[function(e,t,o){"use strict";cc._RF.push(t,"4a2afGWt/NDv4c52r41YDsK","AdsManager");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,s=i.ccclass,c=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.code="ADS_NOT_LOADED",t}return r(t,e),t}(Error)),l=function(){function e(){this.preloadedInterstitial=null,this.preloadedReward=null,this.preloadedBanner=null,this.isLoadedInsterestialAds=!1,this.isLoadedRewardAds=!1,this.isLoadedBannerAds=!1,this.lastShowTime=0,this.adsRetryTime=3e4}var t;return t=e,e.getInstance=function(){return t.instance||(t.instance=new t),t.instance},e.prototype.preloadInterestialAds=function(){var e=this;this.isLoadedInsterestialAds||FBInstant.getInterstitialAdAsync("2001581040017206_2008919755950001").then(function(t){return cc.log(e),e.preloadedInterstitial=t,e.preloadedInterstitial.loadAsync()}).then(function(){console.log("Interstitial preloaded"),e.isLoadedInsterestialAds=!0}).catch(function(t){console.error("Interstitial failed to preload: "+t.message),setTimeout(function(){this.handleAdsNoFill(this.preloadedInterstitial,2)}.bind(e),e.adsRetryTime)})},e.prototype.preloadRewardVideoAds=function(){var e=this;this.isLoadedRewardAds||FBInstant.getRewardedVideoAsync("2001581040017206_2008919929283317").then(function(t){return e.preloadedReward=t,e.preloadedReward.loadAsync()}).then(function(){console.log("reward preloaded"),e.isLoadedRewardAds=!0}).catch(function(e){console.error("reward failed to preload: "+e.message)})},e.prototype.loadBannerAds=function(){try{FBInstant.loadBannerAdAsync("2001581040017206_2008919552616688").then(function(e){console.log("banner",e)}).catch(function(e){console.error("banner failed to load: "+e.message)})}catch(e){console.error(e)}},e.prototype.hideBannerAds=function(){try{FBInstant.hideBannerAdAsync().then(function(){console.log("Banner hide")})}catch(e){console.error(e)}},e.prototype.preload=function(){this.preloadInterestialAds(),this.preloadRewardVideoAds(),this.loadBannerAds()},e.prototype.handleAdsNoFill=function(e,t){var o=this;t>3||e.loadAsync().then(function(){console.log("Interstitial preloaded"),o.isLoadedInsterestialAds=!0}).catch(function(n){console.error("Interstitial failed to preload: "+n.message),setTimeout(function(){o.handleAdsNoFill(e,t+1)},o.adsRetryTime)})},e.prototype.showInterestialAds=function(e){var t=this;void 0===e&&(e=null),Date.now()-this.lastShowTime<this.adsRetryTime?e&&e(Error("CAPPED_TIME")):null!=this.preloadedInterstitial?(cc.audioEngine.pauseMusic(),this.preloadedInterstitial.showAsync().then(function(){t.isLoadedInsterestialAds=!1,console.log("Interstitial ad finished successfully"),t.preloadInterestialAds(),t.lastShowTime=Date.now(),e&&e(null)}).catch(function(t){console.error(t.message),e&&e(t)})):e&&e(Error("NULL inters"))},e.prototype.reloadRewardedAds=function(){this.isLoadedRewardAds=!1,console.log("Rewarded ad finished successfully"),this.preloadRewardVideoAds()},e.prototype.showRewardedAds=function(e){var t=this;if(void 0===e&&(e=null),cc.audioEngine.pauseMusic(),this.preloadedReward&&this.preloadedReward.showAsync().then(function(){t.reloadRewardedAds(),e&&e(null)}).catch(function(o){console.error("ads err",o.message),t.reloadRewardedAds(),e&&e(o)}),!this.preloadedReward){var o=new c("ADS_NOT_LOADED");o.code="ADS_NOT_LOADED",e&&e(o)}},e.prototype.onAdsRewardFail=function(){cc.find("Canvas/UI").getComponent("UIController").showAlert("NO INTERNET CONNECTION",2.5)},e.prototype.getInsterestialPlacementId=function(){return"2001581040017206_2008919755950001"},e.prototype.getRewardPlacementId=function(){return"2001581040017206_2008919929283317"},t=a([s],e)}();o.default=l,cc._RF.pop()},{}],CanvasController:[function(e,t,o){"use strict";cc._RF.push(t,"47a8dl1bOhPP5vH6mWtcG+M","CanvasController");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,s=i.ccclass,c=i.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Canvas=null,t.boardNode=null,t.oldCanvasHeight=0,t.oldCanvasWidth=0,t}return r(t,e),t.prototype.onLoad=function(){var e=this.node;cc.sys.isMobile&&cc.resources.load("bg-mobile",cc.SpriteFrame,null,function(t,o){e.getChildByName("BG").getComponent(cc.Sprite).type=cc.Sprite.Type.SIMPLE,e.getChildByName("BG").getComponent(cc.Sprite).spriteFrame=o}),this.oldCanvasHeight=cc.view.getCanvasSize().height,this.oldCanvasWidth=cc.view.getCanvasSize().width,this.ratio=cc.view.getCanvasSize().height/cc.view.getCanvasSize().width},t.prototype.start=function(){},t.prototype.update=function(){this.ratio<cc.view.getCanvasSize().height/cc.view.getCanvasSize().width?(console.log("screen expand vertically"),this.Canvas.fitHeight=!0,this.oldCanvasHeight=cc.view.getCanvasSize().height,this.oldCanvasWidth=cc.view.getCanvasSize().width,this.ratio=this.oldCanvasHeight/this.oldCanvasWidth):this.ratio>cc.view.getCanvasSize().height/cc.view.getCanvasSize().width&&(console.log("screen expand horizontally"),this.oldCanvasHeight=cc.view.getCanvasSize().height,this.oldCanvasWidth=cc.view.getCanvasSize().width,this.Canvas.fitWidth=!0,this.ratio=this.oldCanvasHeight/this.oldCanvasWidth)},a([c(cc.Canvas)],t.prototype,"Canvas",void 0),a([c(cc.Node)],t.prototype,"boardNode",void 0),a([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],CombineAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"f51cfn/vkxHRIW9tfsdmnlS","CombineAnimation");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,s=i.ccclass,c=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.movingNode=[],t.destinationNodeIndex=[],t.destinationNode=[],t}return r(t,e),a([s],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],FBInstantManager:[function(e,t,o){"use strict";cc._RF.push(t,"109ddSTB8JMy7QaYukCTna2","FBInstantManager");var n=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,i=(r.property,function(){function e(){this.playerId="",this._gameController=cc.find("GameController").getComponent("GameController")}var t;return t=e,e.getInstance=function(){return t.instance||(t.instance=new t),t.instance},e.prototype.getPlayerId=function(){if(!this.playerId)try{this.playerId=FBInstant.player.getID()}catch(e){this.playerId="localId"}if(this.playerId)return this.playerId},e.prototype.getPlayerPhoto=function(){if(this.playerId)return FBInstant.player.getPhoto()},e.prototype.getPlayerName=function(){if(this.playerId)return FBInstant.player.getName()},e.prototype.getShareImg=function(e){var t=this;if(this.shareImg)return e(this.shareImg);cc.resources.load("Base64/ShareImg",function(o,n){t.shareImg=n.text,e(t.shareImg)})},e.prototype.shareGame=function(){this.getShareImg(function(e){var t=FBInstant.player.getID();FBInstant.shareAsync({intent:"REQUEST",image:e,text:"Let's play hexa reach the star!",data:{sharePlayerID:t}})})},e.prototype.invitePlay=function(e){var t=this;void 0===e&&(e={playerId:"",playerScore:0});var o=function(o){FBInstant.getLeaderboardAsync(o).then(function(t){return t.setScoreAsync(e.playerScore,"")}).then(function(){FBInstant.updateAsync({action:"LEADERBOARD",name:o,text:FBInstant.player.getName()+" has been achieved "+e.playerScore+" and invite you to play Hexa Reach The Star"}).then(function(){t._gameController.newGameButton(),cc.log("send invite - update leaderboard"),console.log("send invite - update leaderboard")}).catch(function(e){console.log("errr",e)})}).catch(function(e){console.log("err",e)})},n=FBInstant.context.chooseAsync,r=[];e.playerId&&(n=FBInstant.context.createAsync,r.push(e.playerId)),n.apply(void 0,r).then(function(){var e="Hexa Leaderboard."+FBInstant.context.getID();o(e)}).catch(function(e){void 0===e&&(e=null),console.log("fail?",e)})},e.prototype.getConnectedPlayers=function(e){try{FBInstant.player.getConnectedPlayersAsync().then(function(t){var o=t.map(function(e){return{id:e.getID(),name:e.getName(),photo:e.getPhoto()}});e(o)}).catch(function(e){console.log("get list fail",e)})}catch(t){cc.log("error:",t)}},e.prototype.setPlayerData=function(e,t){try{if(!FBInstant)return t(null)}catch(n){return t(null)}var o={};o.userData=e,FBInstant.player.setDataAsync(o).then(function(){t(null)}).catch(function(e){t(e)})},e.prototype.getPlayerData=function(e){try{if(!FBInstant)return e(null,null)}catch(t){return e(null,null)}FBInstant.player.getDataAsync(["userData"]).then(function(t){e(null,t.userData)}).catch(function(t){e(t,null)})},e.prototype.createShortcut=function(e){try{FBInstant.canCreateShortcutAsync().then(function(t){t&&FBInstant.createShortcutAsync().then(function(){console.log("--- create shortcut success"),e(!0)}).catch(function(){console.log("--- create shortcut fail"),e(!1)}),e(!1)})}catch(t){console.error(t),e(!1)}},e.prototype.subcribeBot=function(e){try{FBInstant.player.canSubscribeBotAsync().then(function(t){t?FBInstant.player.subscribeBotAsync().then(function(){console.log("--- subcribe bot success"),e(!0)}).catch(function(t){console.log("--- subcribe bot fail",t),e(!1)}):e(!1)}).catch(function(t){console.log("can not subcribe bot",t),e(!1)})}catch(t){console.log(t),e(!1)}},e.prototype.getLocale=function(){return FBInstant.getLocale()},e.prototype.setSessionData=function(e){FBInstant.setSessionData(e)},t=n([a],e)}());o.default=i,cc._RF.pop()},{}],FirebaseManager:[function(e,t,o){"use strict";cc._RF.push(t,"63d6aPku2hARIKblgdPR3IX","FirebaseManager");var n=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var r=e("./FBInstantManager"),a=cc._decorator,i=a.ccclass,s=(a.property,"players"),c=function(e,t,o){var n=e.constructor.getInstance(),r=o.value;o.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(n._firebase)return r.apply(n,e);n._lazyCalls.push({func:o.value,args:arguments})}},l=function(){function e(){this._firebase=null,this._db=null,this._lazyCalls=[]}var t;return t=e,e.getInstance=function(){return t._instance?t._instance:(t._instance=new t,t._instance)},e.prototype.initFirebase=function(){var e,t,o,n,r=this;e=0,t=function(){if(++e<2)return n.onload=t,n.src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js",void document.body.appendChild(n);firebase.initializeApp({apiKey:"AIzaSyARjwllaL9Dg8iMXJSn8Mmf6l28RaY71cU",authDomain:"hexa-99e78.firebaseapp.com",databaseURL:"https://hexa-99e78.asia-southeast2.firebasedatabase.app",projectId:"hexa-99e78",storageBucket:"hexa-99e78.appspot.com",messagingSenderId:"633974873366",appId:"1:633974873366:web:9373b5be145afde2240437"}),r._firebase=firebase,r._db=firebase.firestore(),window.firebase=null,r._lazyCalls.forEach(function(e){return e.func.apply(e,e.args)})},o=document.createElement("script"),n=document.createElement("script"),o.onload=t,o.src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js",document.body.appendChild(o)},e.prototype.getPlayerRef=function(e){return e+"/"+r.default.getInstance().getPlayerId()},e.prototype.setData=function(e,t,o){try{this._db.collection(e).doc(t).set(o,{merge:!0}).then(function(){console.log("Document written")}).catch(function(e){console.error("Error adding document: ",e)})}catch(n){console.error("save firebase err: ",n)}},e.prototype.getData=function(e,t,o){this._db.collection(e).doc(t).get().then(function(n){if(n.exists){var r=n.data();o(r)}else console.log("no doc",e,t),o(null,null)}).catch(function(e){o(e)})},e.prototype.setPlayerData=function(e){var t=r.default.getInstance().getPlayerId();"localId"!==t&&this.setData(s,t,e)},e.prototype.getPlayerData=function(e){var t=r.default.getInstance().getPlayerId();if("localId"===t)return e(null,null);this.getData(s,t,e)},e.prototype.getFriendData=function(e,t){if("localId"===r.default.getInstance().getPlayerId())return t(null,null);this.getData(s,e,t)},e.prototype.getConfig=function(e){this._db.collection("config").doc("configId").get().then(function(t){t.exists?e(null,t.data()):e(null,null)}).catch(function(t){e(t,null)})},e.prototype.getLeaderboard=function(e){var t=[];this._db.collection(s).orderBy("bestScore","desc").get().then(function(o){o.empty?(console.log("no doc"),e(null)):(o.docs.forEach(function(e,o){t.push({name:e.data().name,ava:e.data().ava,rank:o+1,id:e.id,bestScore:e.data().bestScore})}),e(t))}).catch(function(t){e(t)})},e._instance=null,n([c],e.prototype,"setPlayerData",null),n([c],e.prototype,"getPlayerData",null),n([c,c],e.prototype,"getConfig",null),n([c],e.prototype,"getLeaderboard",null),t=n([i],e)}();o.default=l,cc._RF.pop()},{"./FBInstantManager":"FBInstantManager"}],GameController:[function(e,t,o){"use strict";cc._RF.push(t,"cf402XHasBL4oc62hnLOMe5","GameController");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./NumberController"),s=e("./SquareController"),c=e("./GuideController"),l=e("./AdsManager"),u=e("./FirebaseManager"),p=e("./FBInstantManager"),d=cc._decorator,h=d.ccclass,f=d.property,m=cc.tween,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.board=null,t.newNumberHolder=null,t.block=null,t.canvasNode=null,t.boom_anim=null,t.pause_board=null,t.gameOverPNG=null,t.screen=null,t.number=null,t.hammerPrefab=null,t.flyingScore=null,t.squareNodeArr=[],t.scoreText=null,t.bestScoreText=null,t.success_sfx=[],t.place_sfx=null,t.place_wrong_sfx=null,t.tap_sfx=null,t.gameover_sfx=null,t.rankTable=null,t.overLay=null,t.userRankPrefab=null,t.rankList=null,t.pauseBtn=null,t.rankBtn=null,t.newNumberArr=[],t.squareArr=[],t.hexaMap=[],t.newNumberMap=[],t.isLoadInterestialAds=!0,t.isCombing=!1,t}return r(t,e),t.prototype.onLoad=function(){var e,t,o;if(u.default.getInstance().initFirebase(),this.isPausing=!1,this.pause_board.active=!1,this.rankTable.active=!1,this.gameOverPNG.active=!1,this.animation_boom=this.boom_anim.getComponent(sp.Skeleton),this.boom_anim.zIndex=3,this.gapX=210,this.gapY=330,this.getSquareControllerComponent(),this.block=this.newNumberHolder.getChildByName("block"),this.newNumberHolder.on(cc.Node.EventType.TOUCH_START,this.onTouchBlockStart,this),this.newNumberHolder.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.newNumberHolder.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.newNumberHolder.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),cc.director.getPhysicsManager().enabled=!0,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),this.node.on("GameOver",this.gameOver,this),this.node.on("loadingPlayerProgressDone",this.startGame,this),"localId"!==p.default.getInstance().getPlayerId())FBInstant.player.getDataAsync(["isPlayingHexa","hexaMap","bestScoreHexa","scoreHexa","typeOfNewBlock","newNumberMap"]).then(function(e){var t,o,n;this.bestScore=e.bestScoreHexa,(null==this.bestScore||isNaN(this.bestScore))&&(FBInstant.player.setDataAsync({bestScoreHexa:0}).then(function(){console.log("bestScoreHexa is set")}),this.bestScore=0),this.score=e.scoreHexa,(null==this.bestScore||isNaN(this.bestScore))&&(this.score=0,FBInstant.player.setDataAsync({scoreHexa:0}).then(function(){console.log("scoreHexa is set")})),this.isPlaying=e.isPlayingHexa,null==this.isPlaying&&(this.isPlaying=!1,FBInstant.player.setDataAsync({isPlayingHexa:this.isPlaying}).then(function(){console.log("isPlayingHexa is set")})),this.typeOfNewBlock=e.typeOfNewBlock,null==this.typeOfNewBlock&&(this.typeOfNewBlock=-1,FBInstant.player.setDataAsync({typeOfNewBlock:this.typeOfNewBlock}).then(function(){console.log("typeOfNewBlock is set")})),this.newNumberMap=e.newNumberMap,null==this.newNumberMap&&(this.newNumberMap=[null,null,null],FBInstant.player.setDataAsync({newNumberMap:this.newNumberMap}).then(function(){console.log("newNumberMap is set")}));var r=null!==(t=e.hexaMap)&&void 0!==t?t:"";if(0==",,,,,,,,,,,,,,,,,,".localeCompare(r)||0==r.length)this.hexaMap=new Array(19);else{var a=null!==(o=e.hexaMap)&&void 0!==o?o:[];0==a.length?(this.hexaMap=new Array(19),FBInstant.player.setDataAsync({hexaMap:this.hexaMap}).then(function(){console.log("hexaMap is set")})):this.hexaMap=a}var i=null!==(n=e.newNumberMap)&&void 0!==n?n:"";if(0==",,".localeCompare(i)||0==i.length)this.newNumberMap=[],this.typeOfNewBlock=-1;else{var s=e.newNumberMap;0==s.length?(this.newNumberMap=[],this.typeOfNewBlock=-1,FBInstant.player.setDataAsync({newNumberMap:this.newNumberMap}).then(function(){console.log("hexnewNumberMapaMap is set")})):this.newNumberMap=s}this.node.emit("loadingPlayerProgressDone")}.bind(this));else{this.bestScore=parseInt(cc.sys.localStorage.getItem("bestScoreHexa")),(null==this.bestScore||isNaN(this.bestScore))&&(cc.sys.localStorage.setItem("bestScoreHexa",0),this.bestScore=0),this.score=parseInt(cc.sys.localStorage.getItem("scoreHexa")),(null==this.bestScore||isNaN(this.bestScore))&&(this.score=0,cc.sys.localStorage.setItem("scoreHexa",0)),this.isPlaying=cc.sys.localStorage.getItem("isPlayingHexa"),this.isPlaying="true"===this.isPlaying,null==this.isPlaying&&(this.isPlaying=!1,cc.sys.localStorage.setItem("isPlayingHexa",this.isPlaying)),this.typeOfNewBlock=parseInt(cc.sys.localStorage.getItem("typeOfNewBlock")),null==this.typeOfNewBlock&&(this.typeOfNewBlock=-1,cc.sys.localStorage.setItem("typeOfNewBlock",this.typeOfNewBlock)),this.newNumberMap=cc.sys.localStorage.getItem("newNumberMap"),null==this.newNumberMap&&(this.newNumberMap=[null,null,null],cc.sys.localStorage.setItem("newNumberMap",this.newNumberMap));var n=null!==(e=cc.sys.localStorage.getItem("hexaMap"))&&void 0!==e?e:"";if(0==",,,,,,,,,,,,,,,,,,".localeCompare(n)||0==n.length)this.hexaMap=new Array(19),console.log(this.hexaMap);else{var r=null!==(t=JSON.parse(cc.sys.localStorage.getItem("hexaMap")))&&void 0!==t?t:[];0==r.length?(this.hexaMap=new Array(19),cc.sys.localStorage.setItem("hexaMap",JSON.stringify(this.hexaMap))):this.hexaMap=r}var a=null!==(o=cc.sys.localStorage.getItem("newNumberMap"))&&void 0!==o?o:"";if(0==",,".localeCompare(a)||0==a.length)this.newNumberMap=[],this.typeOfNewBlock=-1;else{var i=JSON.parse(cc.sys.localStorage.getItem("newNumberMap"));0==i.length?(this.newNumberMap=[],this.typeOfNewBlock=-1,cc.sys.localStorage.setItem("newNumberMap",JSON.stringify(this.newNumberMap))):this.newNumberMap=i}this.node.emit("loadingPlayerProgressDone")}if("localId"!==p.default.getInstance().getPlayerId())try{l.default.getInstance().preload()}catch(s){console.log(s)}},t.prototype.onEnable=function(){var e=this;"localId"!==p.default.getInstance().getPlayerId()&&this.askSubcribeBot(function(){e.askCreateShortcut()})},t.prototype.askSubcribeBot=function(e){p.default.getInstance().subcribeBot(function(){e&&e()})},t.prototype.askCreateShortcut=function(e){p.default.getInstance().getPlayerData(function(t,o){if(t)return e&&e(),console.log("--- fb instant get data err",t);o||(o={hadCreatedShortcut:!1,visited:1}),o.visited?o.visited++:o.visited=1,o.hadCreatedShortcut||o.visited<2||p.default.getInstance().createShortcut(function(t){t&&(o.hadCreatedShortcut=!0,p.default.getInstance().setPlayerData(o,function(e){e&&console.log("--- fb instant set data err",e)})),e&&e()})})},t.prototype.start=function(){},t.prototype.startGame=function(){this.getComponent(c.default).isNewBie()?(this.getComponent(c.default).increaseGuideLevel(),this.getComponent(c.default).loadGuide()):1==this.isPlaying?this.loadOldGame():this.newGame(),this.updateScore()},t.prototype.loadOldGame=function(){this.clearTable();for(var e=0;e<19;++e)if(null!=this.hexaMap[e]){var t=cc.instantiate(this.number).getComponent(i.default);t.node.setParent(this.board),this.setValue(t,this.hexaMap[e]),t.node.setPosition(this.squareArr[e].node.position),this.squareArr[e].placedNumber=t,t.stackingSquare=this.squareArr[e],this.squareArr[e].node.opacity=20}switch(this.typeOfNewBlock){case-1:this.respondNewNumber();break;case 1:this.loadSingleNewNumber();break;case 2:this.loadDoubleNewNumber()}this.updateScore()},t.prototype.loadDoubleNewNumber=function(){this.respondDoubleBlock(),this.newNumberArr[0].value=this.newNumberMap[0],this.newNumberArr[0].updateText(),this.newNumberArr[1].value=this.newNumberMap[1],this.newNumberArr[1].updateText()},t.prototype.loadSingleNewNumber=function(){this.respondSingleBlock(),this.newNumberArr[0].value=this.newNumberMap[0],this.newNumberArr[0].updateText(),-1==this.newNumberArr[0].value&&this.respond_bomb()},t.prototype.onKeyDown=function(e){switch(e.keyCode){case cc.macro.KEY.tab:this.isPlaying||this.checkHexa()}},t.prototype.onTouchMove=function(e){if(1==this.isPlaying&&0==this.isPausing){var t=e.touch.getDelta();this.block.x+=t.x,this.block.y+=t.y}},t.prototype.onTouchBlockStart=function(e){this.isCombing||(this.isPlaying&&!this.isPausing?(this.touchStartLocation=e.getLocation(),m(this.block).to(.05,{scale:1.05}).start()):0==this.isPausing&&this.newGame()),e.stopPropagationImmediate()},t.prototype.onTouchEnd=function(e){if(!this.isCombing)if(this.isPlaying&&!this.isPausing){this.touchEndLocation=e.getLocation();var t=this.touchEndLocation.y-this.touchStartLocation.y;m(this.block).to(.05,{scale:1}).start(),Math.abs(t)>10?this.relocateBlock():this.touchEndLocation.y<500&&this.rotateBlock()}else this.isPlaying=!0},t.prototype.relocateBlock=function(){this.allInTable()?this.placeBlockInTable():(m(this.block).to(.05,{position:cc.v3(0,0,0)},{easing:"cubicOut"}).start(),cc.audioEngine.playEffect(this.place_wrong_sfx,!1))},t.prototype.combineNumber=function(e){var t=this;if(this.isCombing=!0,e!=this.newNumberArr.length&&-1!=this.newNumberArr[0].value){if(null!=this.newNumberArr[0].stackingSquare&&0==e&&2==this.newNumberArr.length&&this.newNumberArr[0].value==this.newNumberArr[1].value){var o=this.newNumberArr[0].stackingSquare.linkedSquareList,n=0;for(n=0;n<o.length&&(null==o[n].placedNumber||o[n].placedNumber.value!=this.newNumberArr[0].value+1);++n);if(n==o.length){var r=this.newNumberArr[1];this.newNumberArr[0]=r,this.newNumberArr[1]=this.newNumberArr[0]}}var a=0;this.visitedSquareIndex=[],null!=this.newNumberArr[e].stackingSquare&&-1==this.visitedSquareIndex.indexOf(this.newNumberArr[e].stackingSquare.index)?(this.sameNumberArr=[],this.searchSameNumber(this.newNumberArr[e]),this.sameNumberArr.length>1?m(this.newNumberArr[e]).delay(.5*a).call(function(){for(var o=function(o){m(t.sameNumberArr[o].node).parallel(m().call(function(){t.sameNumberArr[o]&&(t.sameNumberArr[o].node.zIndex=1,t.sameNumberArr[o].stackingSquare.node.opacity=150)}).to(.3,{position:t.newNumberArr[e].node.position}),m().by(.15,{scale:.25}).by(.15,{scale:-.25})).call(function(){t.sameNumberArr[o]&&(t.sameNumberArr[o].node.active=!1,t.sameNumberArr[o].node.destroy())}).start()},n=0;n<t.sameNumberArr.length;++n)o(n)}).delay(.5).call(function(){++t.newNumberArr[e].value,t.newNumberArr[e].updateText(),t.boom_anim.position=t.newNumberArr[e].node.position;var o=t.newNumberArr[e].node.parent.convertToWorldSpaceAR(t.newNumberArr[e].node.position);o=t.canvasNode.convertToNodeSpaceAR(o);var n=t.countDuplicateItem(t.sameNumberArr),r=t.sameNumberArr[0].value,i=t.sameNumberArr.length;t.popFlyingScore(t.caculatorScore(i-n+1,r),o),t.newNumberArr[e].value<7?t.animation_boom.setAnimation(0,"fx_2",!1):(t.animation_boom.setAnimation(0,"fx_2",!1),m(t.newNumberArr[e].node).delay(.5).call(function(){t.newNumberArr[e].stackingSquare.node.opacity=150}).to(.3,{opacity:0}).call(function(){t.animation_boom.setAnimation(0,"fx_1",!1),t.newNumberArr[e].node.active=!1,t.popFlyingScore(50,o),t.isLoadInterestialAds&&l.default.getInstance().showInterestialAds()}).start()),++a}).delay(.85).call(function(){for(var e=0;e<t.squareArr.length;++e)null==t.squareArr[e].placedNumber||null!=t.squareArr[e].placedNumber.node&&0!=t.squareArr[e].placedNumber.node.active||(t.squareArr[e].placedNumber=null);t.combineNumber(0)}).start():this.combineNumber(++e)):this.combineNumber(++e),this.getComponent(c.default).isNewBie()&&this.getComponent(c.default).increaseGuideLevel()}else{for(var i=0;i<this.squareArr.length;++i)null==this.squareArr[i].placedNumber||null!=this.squareArr[i].placedNumber.node&&0!=this.squareArr[i].placedNumber.node.active||(this.squareArr[i].placedNumber=null);this.respondNewNumber()}},t.prototype.updateScore=function(){this.score>this.bestScore&&(this.bestScore=this.score),this.bestScoreText.string=this.bestScore.toString(),this.scoreText.string=this.score.toString()},t.prototype.searchSameNumber=function(e){var t=[];this.visitedSquareIndex.push(e.stackingSquare.index);for(var o=0;o<e.stackingSquare.linkedSquareList.length;++o)e.stackingSquare.linkedSquareList[o].placedNumber;for(o=0;o<e.stackingSquare.linkedSquareList.length;++o)-1==this.visitedSquareIndex.lastIndexOf(e.stackingSquare.linkedSquareList[o].index)&&null!=e.stackingSquare.linkedSquareList[o].placedNumber&&e.stackingSquare.linkedSquareList[o].placedNumber.value==e.value&&null!=e.stackingSquare.linkedSquareList[o].placedNumber.stackingSquare&&(t.push(e.stackingSquare.linkedSquareList[o].index),this.sameNumberArr.push(e.stackingSquare.linkedSquareList[o].placedNumber));for(var n=0;n<t.length;++n)this.searchSameNumber(this.squareArr[t[n]].placedNumber)},t.prototype.placeBlockInTable=function(){var e=this;if(-1!=this.newNumberArr[0].value){for(var t=0;t<this.squareArr.length;++t)null!=this.squareArr[t].stackingNumber&&(this.squareArr[t].placedNumber=this.squareArr[t].stackingNumber,this.squareArr[t].placedNumber.stackingSquare=this.squareArr[t],this.changeParent(this.squareArr[t].placedNumber.node,this.board),m(this.squareArr[t].placedNumber.node).to(.1,{position:this.squareArr[t].placedNumber.stackingSquare.node.position}).start());this.combineNumber(0)}else-1==this.newNumberArr[0].value&&m(this.newNumberArr[0].node).call(function(){e.hammer.node.y+=140,e.hammer.node.x+=100,e.hammer.setAnimation(0,"dapbua",!1),null==e.newNumberArr[0].stackingSquare.placedNumber&&(e.newNumberArr[0].stackingSquare.node.opacity=150)}).delay(1).call(function(){e.newNumberArr[0].node.opacity=0;for(var t=e.newNumberArr[0].stackingSquare.linkedSquareList,o=function(o){null!=t[o].placedNumber&&m(t[o].placedNumber.node).delay(.3*o).parallel(m().to(.3,{opacity:0}),m(t[o].placedNumber.node).to(.3,{opacity:150}).start()).call(function(){e.boom_anim.position=t[o].placedNumber.node.position,e.animation_boom.setAnimation(0,"fx_1",!1),t[o].placedNumber.node.active=!1,t[o].node.opacity=150}).start()},n=0;n<t.length;++n)o(n);null!=e.newNumberArr[0].stackingSquare.placedNumber?m(e.newNumberArr[0].stackingSquare.placedNumber.node).delay(.3*t.length).parallel(m().to(.3,{opacity:0}),m(e.newNumberArr[0].stackingSquare.node).to(.3,{opacity:150}).start()).call(function(){e.boom_anim.position=e.newNumberArr[0].stackingSquare.placedNumber.node.position,e.animation_boom.setAnimation(0,"fx_1",!1),e.newNumberArr[0].stackingSquare.placedNumber.node.active=!1,e.cleanTableAndRespond()}).start():m(e.node).delay(.3*t.length).call(function(){e.cleanTableAndRespond()}).start()}).start();cc.audioEngine.playEffect(this.place_sfx,!1)},t.prototype.cleanTableAndRespond=function(){for(var e=0;e<this.squareArr.length;++e)null==this.squareArr[e].placedNumber||null!=this.squareArr[e].placedNumber.node&&0!=this.squareArr[e].placedNumber.node.active||(this.squareArr[e].placedNumber=null);for(var t=0;t<this.newNumberArr.length;++t)null!=this.newNumberArr[t]&&(this.newNumberArr[t].node.active=!1,this.newNumberArr[t].node.destroy(),this.newNumberArr[t]=null);this.respondNewNumber()},t.prototype.printCurrentMap=function(){for(var e=0;e<this.squareArr.length;++e)null!=this.squareArr[e].placedNumber?console.log(this.squareArr[e].index+" - "+this.squareArr[e].placedNumber.value):console.log(this.squareArr[e].index+" - NO PLACED NUMBER")},t.prototype.changeParent=function(e,t){if(e.parent!=t){var o=function(e){var t=e,o=t.angle;do{o+=(t=t.parent).angle}while(null!=t.parent);return o%360},n=o(e)-o(t),r=e.convertToWorldSpaceAR(cc.v3(0,0,0)),a=t.convertToNodeSpaceAR(r);e.parent=t,e.position=a,e.angle=n}},t.prototype.allInTable=function(){for(var e=0;e<this.newNumberArr.length;++e)if(null==this.newNumberArr[e].stackingSquare)return!1;return!0},t.prototype.newGame=function(){cc.tween(this.getComponent(cc.AudioSource)).to(.5,{volume:.3}).start(),this.clearTable(),this.disappear(this.gameOverPNG),this.score=0,this.createRandomNumberOnTable(),this.respondNewNumber(),this.isPlaying=!0,this.hexaMap=[],this.updateScore()},t.prototype.createRandomNumberOnTable=function(){var e=cc.instantiate(this.number).getComponent(i.default),t=cc.instantiate(this.number).getComponent(i.default);e.node.scale=.1,t.node.scale=.1,e.node.setParent(this.board),t.node.setParent(this.board),this.chooseValue(e),this.chooseValue(t);var o=Math.floor(18*Math.random()),n=this.squareArr[o].node;e.node.setPosition(n.position),this.squareArr[o].placedNumber=e,e.stackingSquare=this.squareArr[o];for(var r=Math.floor(18*Math.random());o==r;)r=Math.floor(18*Math.random());n=this.squareArr[r].node,t.node.setPosition(n.position),this.squareArr[r].placedNumber=t,t.stackingSquare=this.squareArr[r],m(e.node).to(.1,{scale:1}).start(),m(t.node).to(.1,{scale:1}).start()},t.prototype.clearTable=function(){for(var e=0;e<this.squareArr.length;++e)null!=this.squareArr[e].placedNumber?(this.squareArr[e].placedNumber.node.active=!1,this.squareArr[e].placedNumber.node.destroy(),this.squareArr[e].node.opacity=150):this.squareArr[e].node.opacity=150,this.squareArr[e].placedNumber=null;for(e=0;e<this.newNumberArr.length;++e)this.newNumberArr[e].node.active=!1,this.newNumberArr[e].node.destroy(),this.newNumberArr[e]=null},t.prototype.respondNewNumber=function(){if(this.getComponent(c.default).isNewBie()&&this.getComponent(c.default).guideLevel<=2)this.getComponent(c.default).setPieceBlock();else{this.getComponent(c.default).isNewBie&&this.getComponent(c.default).finishGuide();var e=this.checkPlayable();if(this.newNumberArr=[],this.block.setPosition(cc.v3(0,0,0)),this.block.angle=0,2==e){var t=Math.random();t<.5?(this.respondSingleBlock(),this.typeOfNewBlock=1):t<1&&(this.respondDoubleBlock(),this.typeOfNewBlock=2)}else 1==e?(this.respondSingleBlock(),this.typeOfNewBlock=1):this.node.emit("gameOver");this.newNumberArr.sort(function(e,t){return e.value==t.value?0:e.value>t.value?1:e.value<t.value?-1:void 0}),this.storeGameData()}},t.prototype.checkPlayable=function(){return 1==this.checkPlayable_2()?2:1==this.checkPlayable_1()?1:(this.storeGameData(),this.node.emit("GameOver"),0)},t.prototype.storeGameData=function(){for(var e=0;e<this.squareArr.length;++e)null==this.squareArr[e].placedNumber?this.hexaMap[e]=null:this.hexaMap[e]=this.squareArr[e].placedNumber.value;for(e=0;e<this.newNumberArr.length;++e)null==this.newNumberArr[e]?this.newNumberMap[e]=null:this.newNumberMap[e]=this.newNumberArr[e].value;"localId"!==p.default.getInstance().getPlayerId()?FBInstant.player.setDataAsync({isPlayingHexa:this.isPlaying,hexaMap:this.hexaMap,bestScoreHexa:this.bestScore,scoreHexa:this.score,typeOfNewBlock:this.typeOfNewBlock,newNumberMap:this.newNumberMap}).then(function(){console.log("data is set")}):(cc.sys.localStorage.setItem("newNumberMap",JSON.stringify(this.newNumberMap)),cc.sys.localStorage.setItem("hexaMap",JSON.stringify(this.hexaMap)),cc.sys.localStorage.setItem("isPlayingHexa",this.isPlaying),cc.sys.localStorage.setItem("typeOfNewBlock",this.typeOfNewBlock),cc.sys.localStorage.setItem("scoreHexa",this.score),cc.sys.localStorage.setItem("bestScoreHexa",this.bestScore))},t.prototype.checkPlayable_3=function(){for(var e=0;e<this.squareArr.length;++e)if(null==this.squareArr[e].placedNumber)for(var t=this.squareArr[e],o=0;o<t.linkedSquareList.length;++o)if(null==this.squareArr[e].linkedSquareList[o].placedNumber){var n=this.squareArr[e].linkedSquareList[o];if(null!=this.squareArr[n.index+(n.index-t.index)]&&null==this.squareArr[n.index+(n.index-t.index)].placedNumber&&n.index-t.index==this.squareArr[n.index+(n.index-t.index)].index-n.index)return;if(n.index-t.index==5&&(null==this.squareArr[n.index+1]||null==this.squareArr[n.index+4]))return;if(n.index-t.index==4&&(null==this.squareArr[n.index-1]||null==this.squareArr[n.index+5]))return}this.node.emit("gameOver")},t.prototype.checkPlayable_2=function(){for(var e=!1,t=0;t<this.squareArr.length;++t)if(null==this.squareArr[t].placedNumber)for(var o=0;o<this.squareArr[t].linkedSquareList.length;++o)null==this.squareArr[t].linkedSquareList[o].placedNumber&&(e=!0);return e},t.prototype.checkPlayable_1=function(){for(var e=!1,t=0;t<this.squareArr.length;++t)null==this.squareArr[t].placedNumber&&(e=!0);return e},t.prototype.chooseValue=function(e){var t=Math.random();t<.05?e.value=6:t<44/300?e.value=5:t<.29?e.value=4:t<.48?e.value=3:t<215/300&&(e.value=2),e.updateText()},t.prototype.setValue=function(e,t){e.value=t,e.updateText()},t.prototype.respondDoubleBlock=function(){var e=cc.instantiate(this.number).getComponent(i.default),t=cc.instantiate(this.number).getComponent(i.default);e.node.scale=.1,t.node.scale=.1,e.node.setParent(this.block),t.node.setParent(this.block),this.chooseValue(e),this.chooseValue(t),e.node.setPosition(this.block.position.x-this.gapX/2,this.block.position.y),t.node.setPosition(this.block.position.x+this.gapX/2,this.block.position.y),m(e.node).to(.1,{scale:1}).start(),m(t.node).to(.1,{scale:1}).start(),this.newNumberArr.push(e),this.newNumberArr.push(t),this.isCombing=!1},t.prototype.respondSingleBlock=function(){var e=cc.instantiate(this.number).getComponent(i.default);e.node.scale=.1,e.node.setParent(this.block),this.chooseValue(e),e.node.setPosition(this.block.position),m(e.node).to(.1,{scale:1}).start(),this.newNumberArr.push(e),this.isCombing=!1},t.prototype.rotateBlock=function(){cc.audioEngine.playEffect(this.tap_sfx,!1),this.newNumberArr.length>1?(m(this.block).to(.05,{position:cc.v3(0,0,0)}).by(.1,{angle:-60}).start(),this.newNumberArr.forEach(function(e){m(e.node).delay(.05).by(.1,{angle:60}).start()})):m(this.block).to(.05,{position:cc.v3(0,0,0)}).start()},t.prototype.getSquareControllerComponent=function(){for(var e=0;e<this.squareNodeArr.length;++e)this.squareArr.push(this.squareNodeArr[e].getComponent(s.default)),this.squareArr[e].index=e},t.prototype.checkHexa=function(){for(var e=this,t=function(t){m(o.squareNodeArr[t]).delay(2*t).by(.2,{opacity:150}).call(function(){for(var o=0;o<e.squareArr[t].linkedSquareList.length;++o)m(e.squareArr[t].linkedSquareList[o].node).delay(.2*o).by(.15,{opacity:100}).by(.15,{opacity:-100}).start()}).delay(1).by(.2,{opacity:-150}).start()},o=this,n=0;n<this.squareArr.length;++n)t(n)},t.prototype.gameOver=function(){var e=this;cc.tween(this.getComponent(cc.AudioSource)).to(.5,{volume:0}).start(),cc.audioEngine.playEffect(this.gameover_sfx,!1);var t=this.gameOverPNG;this.isPlaying=!1,this.isPausing=!0,m(t).delay(1).call(function(){e.disappear(e.block),t.scale=.1,t.active=!0}).to(.5,{scale:1}).start(),this.changeStateOverLay(),this.storeGameData(),this.savaDataToFireBase()},t.prototype.pauseGame=function(){this.pause_board.getChildByName("score").getComponent(cc.Label).string=String(this.score),this.isPausing=!0,this.appear(this.pause_board),this.changeStateOverLay()},t.prototype.continueGame=function(){this.isPausing=!1,this.disappear(this.pause_board),this.changeStateOverLay()},t.prototype.newGameButton=function(){cc.audioEngine.playEffect(this.tap_sfx,!1),this.disappear(this.pause_board),this.appear(this.block),this.block.active=!0,this.isPausing=!1,this.newGame(),this.changeStateOverLay()},t.prototype.appear=function(e){e.scale=.1,e.active=!0,m(e).to(.1,{scale:1}).start()},t.prototype.disappear=function(e){m(e).to(.1,{scale:.1}).call(function(){e.active=!1}).start()},t.prototype.playAgain=function(){var e=this;cc.audioEngine.playEffect(this.tap_sfx,!1),this.changeStateOverLay(),l.default.getInstance().showRewardedAds(function(){cc.tween(e.getComponent(cc.AudioSource)).to(.5,{volume:.3}).start(),e.isPlaying=!0,e.isPausing=!1,e.disappear(e.gameOverPNG),e.respond_bomb(),e.storeGameData()})},t.prototype.respond_bomb=function(){for(var e=0;e<this.newNumberArr.length;++e)this.newNumberArr[e].node.active=!1,this.newNumberArr[e].node.destroy(),this.newNumberArr[e]=null;this.newNumberArr=[],this.block.setPosition(cc.v3(0,0,0)),this.block.angle=0,this.respondSingleBlock(),this.hammer=cc.instantiate(this.hammerPrefab).getComponent(sp.Skeleton),this.hammer.node.setParent(this.newNumberArr[0].node),this.hammer.node.setPosition(0,-280,0),this.appear(this.block),this.newNumberArr[0].value=-1,this.newNumberArr[0].updateText()},t.prototype.popFlyingScore=function(e,t){var o=this,n=cc.instantiate(this.flyingScore);n.setParent(this.screen),n.setPosition(t),n.active=!0,n.getComponent(cc.Label).string="+"+e;var r=150*Math.random()+50,a=360*Math.random();n.setScale(.01),cc.tween(n).parallel(m().by(.1,{x:r*Math.cos(a),y:r*Math.sin(a)},{easing:"cubicIn"}),m().by(.1,{scale:1})).to(1.5,{position:this.scoreText.node.position,opacity:10},{easing:"cubicIn"}).call(function(){o.addScore(e),n.destroy()}).start()},t.prototype.addScore=function(e){this.score+=e,this.updateScore(),cc.sys.localStorage.setItem("scoreHexa",this.score),"localId"!==p.default.getInstance().getPlayerId()&&FBInstant.player.setDataAsync({bestScoreHexa:this.bestScore,scoreHexa:this.score}).then(function(){this.savaDataToFireBase()}.bind(this))},t.prototype.changeStateRankTable=function(){var e=this;0===this.rankTable.x?(this.isPausing=!1,cc.tween(this.rankTable).to(.3,{position:cc.v3(-1642,0,0)}).call(function(){e.rankTable.active=!1}).start()):(this.renderRank(),this.isPausing=!0,this.rankTable.active=!0,cc.tween(this.rankTable).to(.3,{position:cc.v3(0,0,0)}).start()),this.changeStateOverLay()},t.prototype.animWhenClick=function(e){cc.audioEngine.playEffect(this.tap_sfx,!1),cc.tween(e.target).to(.1,{scale:1.2}).to(.1,{scale:1}).start()},t.prototype.closeOptionTable=function(){cc.audioEngine.playEffect(this.tap_sfx,!1),this.disappear(this.pause_board),this.isPausing=!1,this.changeStateOverLay()},t.prototype.changeStateOverLay=function(){var e=this;200===this.overLay.opacity?cc.tween(this.overLay).to(.1,{opacity:0}).call(function(){e.overLay.active=!1}).start():(this.overLay.active=!0,cc.tween(this.overLay).to(.1,{opacity:200}).start())},t.prototype.savaDataToFireBase=function(){this.score>=this.bestScore&&"localId"!==p.default.getInstance().getPlayerId()&&u.default.getInstance().setPlayerData({bestScore:this.bestScore,ava:p.default.getInstance().getPlayerPhoto(),name:p.default.getInstance().getPlayerName()})},t.prototype.renderRank=function(){var e=this;this.rankList.removeAllChildren(),u.default.getInstance().getLeaderboard(function(t){var o=-84;t.length>0&&t.forEach(function(t){t.id===p.default.getInstance().getPlayerId()&&(e.rankTable.getChildByName("your rank").getComponent(cc.Label).string="Your rank is number "+t.rank);var n=cc.instantiate(e.userRankPrefab);n.getChildByName("rank").getComponent(cc.Label).string=t.rank,n.getChildByName("username").getComponent(cc.Label).string=t.name,n.getChildByName("user-best-score").getComponent(cc.Label).string="Score: "+t.bestScore,n.parent=e.rankList,n.setPosition(0,o),o-=160})})},t.prototype.onClickInviteFriendBtn=function(){p.default.getInstance().invitePlay({playerId:"",playerScore:this.score})},t.prototype.onClickShareBtn=function(){p.default.getInstance().shareGame()},t.prototype.caculatorScore=function(e,t){var o=0;function n(e,t){for(var o=0;o<t;o++)e*=2;return e}switch(e){case 3:o=n(6,t-1);break;case 4:o=n(7,t-1);break;case 5:o=n(10,t-1);break;default:o=n(15,t-1)}return o},t.prototype.countDuplicateItem=function(e){var t,o,n=0;if(e.length>2)for(var r=0;r<=e.length;r++)for(var a=r+1;a<=e.length;a++)(null===(t=e[r])||void 0===t?void 0:t.uuid)===(null===(o=e[a])||void 0===o?void 0:o.uuid)&&n++;return n},t.prototype.onClickResetBestScore=function(){FBInstant.player.setDataAsync({bestScoreHexa:0}).then(function(){u.default.getInstance().setPlayerData({bestScore:0})})},a([f(cc.Node)],t.prototype,"board",void 0),a([f(cc.Node)],t.prototype,"newNumberHolder",void 0),a([f(cc.Node)],t.prototype,"block",void 0),a([f(cc.Node)],t.prototype,"canvasNode",void 0),a([f(cc.Node)],t.prototype,"boom_anim",void 0),a([f(cc.Node)],t.prototype,"pause_board",void 0),a([f(cc.Node)],t.prototype,"gameOverPNG",void 0),a([f(cc.Node)],t.prototype,"screen",void 0),a([f(cc.Prefab)],t.prototype,"number",void 0),a([f(cc.Prefab)],t.prototype,"hammerPrefab",void 0),a([f(cc.Prefab)],t.prototype,"flyingScore",void 0),a([f([cc.Node])],t.prototype,"squareNodeArr",void 0),a([f(cc.Label)],t.prototype,"scoreText",void 0),a([f(cc.Label)],t.prototype,"bestScoreText",void 0),a([f([cc.AudioClip])],t.prototype,"success_sfx",void 0),a([f(cc.AudioClip)],t.prototype,"place_sfx",void 0),a([f(cc.AudioClip)],t.prototype,"place_wrong_sfx",void 0),a([f(cc.AudioClip)],t.prototype,"tap_sfx",void 0),a([f(cc.AudioClip)],t.prototype,"gameover_sfx",void 0),a([f(cc.Node)],t.prototype,"rankTable",void 0),a([f(cc.Node)],t.prototype,"overLay",void 0),a([f(cc.Prefab)],t.prototype,"userRankPrefab",void 0),a([f(cc.Node)],t.prototype,"rankList",void 0),a([f(cc.Node)],t.prototype,"pauseBtn",void 0),a([f(cc.Node)],t.prototype,"rankBtn",void 0),a([h],t)}(cc.Component);o.default=g,cc._RF.pop()},{"./AdsManager":"AdsManager","./FBInstantManager":"FBInstantManager","./FirebaseManager":"FirebaseManager","./GuideController":"GuideController","./NumberController":"NumberController","./SquareController":"SquareController"}],GuideController:[function(e,t,o){"use strict";cc._RF.push(t,"996959GWMNIGJnzqf51Skn2","GuideController");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,s=i.ccclass,c=i.property,l=cc.tween,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.guideBoard=null,t.guideAnim=null,t.guideLevel=0,t}return r(t,e),t.prototype.onLoad=function(){cc.sys.localStorage.getItem("isNewBie")||cc.sys.localStorage.setItem("isNewBie",!0)},t.prototype.start=function(){this.isNewBie()?(this.getComponent("GameController").pauseBtn.active=!1,this.getComponent("GameController").rankBtn.active=!1):(this.guideBoard.active=!1,this.guideAnim.active=!1)},t.prototype.isNewBie=function(){return"true"===cc.sys.localStorage.getItem("isNewBie")},t.prototype.loadGuide=function(){this.getComponent("GameController").clearTable(),this.getComponent("GameController").score=0,this.createPieceToBoard(2,13),this.createPieceToBoard(4,14),this.createPieceToBoard(2,12),this.createPieceToBoard(6,8),this.createPieceToBoard(3,4),this.setPieceBlock()},t.prototype.increaseGuideLevel=function(){this.guideLevel++},t.prototype.finishGuide=function(){cc.sys.localStorage.setItem("isNewBie",!1),this.guideAnim.active=!1,this.guideBoard.active=!1,this.getComponent("GameController").pauseBtn.active=!0,this.getComponent("GameController").rankBtn.active=!0},t.prototype.createPieceToBoard=function(e,t){var o=cc.instantiate(this.getComponent("GameController").number).getComponent("NumberController");o.node.scale=.1,o.node.setParent(this.getComponent("GameController").board),o.value=e,o.updateText();var n=t,r=this.getComponent("GameController").squareArr[n].node;o.node.setPosition(r.position),this.getComponent("GameController").squareArr[n].placedNumber=o,o.stackingSquare=this.getComponent("GameController").squareArr[n],l(o.node).to(.1,{scale:1}).start()},t.prototype.createPieceToBlock=function(e){var t=this;e.forEach(function(o,n){var r=cc.instantiate(t.getComponent("GameController").number).getComponent("NumberController");r.node.scale=.1,r.node.setParent(t.getComponent("GameController").block),r.value=o,r.updateText(),e.length>1?0===n?r.node.setPosition(t.getComponent("GameController").block.position.x-t.getComponent("GameController").gapX/2,t.getComponent("GameController").block.position.y):r.node.setPosition(t.getComponent("GameController").block.position.x+t.getComponent("GameController").gapX/2,t.getComponent("GameController").block.position.y):r.node.setPosition(t.getComponent("GameController").block.position),l(r.node).to(.1,{scale:1}).start(),t.getComponent("GameController").newNumberArr.push(r)}),this.getComponent("GameController").typeOfNewBlock=e.length,this.getComponent("GameController").isCombing=!1},t.prototype.setPieceBlock=function(){switch(this.getComponent("GameController").isPlaying=!0,this.getComponent("GameController").hexaMap=[],this.getComponent("GameController").updateScore(),this.getComponent("GameController").newNumberArr=[],this.getComponent("GameController").block.setPosition(cc.v3(0,0,0)),this.getComponent("GameController").block.angle=0,this.guideLevel){case 1:this.createPieceToBlock([2]);break;case 2:this.createPieceToBlock([3,4])}this.getComponent("GameController").newNumberArr.sort(function(e,t){return e.value==t.value?0:e.value>t.value?1:e.value<t.value?-1:void 0}),this.getComponent("GameController").storeGameData(),this.playAnimGuide(),this.setTextGuide()},t.prototype.playAnimGuide=function(){this.guideAnim.getComponent(cc.Animation).play("guide"+this.guideLevel)},t.prototype.setTextGuide=function(){var e=this.guideBoard.getChildByName("text guide").getChildByName("title").getComponent(cc.Label),t=this.guideBoard.getChildByName("text guide").getChildByName("desc").getComponent(cc.Label);switch(this.guideLevel){case 1:e.string="Hi, let's play Hexa",t.string="Drag and drop pieces onto the board \n to merge the same pieces";break;case 2:e.string="Great !!!",t.string="You can change the shape of two pieces \n by clicking on it"}},a([c(cc.Node)],t.prototype,"guideBoard",void 0),a([c(cc.Node)],t.prototype,"guideAnim",void 0),a([s],t)}(cc.Component);o.default=u,cc._RF.pop()},{}],NumberController:[function(e,t,o){"use strict";cc._RF.push(t,"edf4b4j4kxDjZg6Tc8L3hfH","NumberController");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./SquareController"),s=e("./NumberController"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text=null,t.spriteList=[],t.stackingSquare=null,t}return r(t,e),t.prototype.onLoad=function(){this.value=1,cc.director.getCollisionManager().enabled=!0},t.prototype.onCollisionEnter=function(e,t){if(0==e.tag){var o=e.getComponent(i.default),n=t.getComponent(s.default);null==o.placedNumber?n.stackingSquare=o:-1==t.getComponent(s.default).value&&(console.log("TAKE STACKING SQUARE!!!!"),n.stackingSquare=o)}},t.prototype.onCollisionExit=function(e,t){var o=e.getComponent(i.default),n=t.getComponent(s.default);0==e.tag&&o==n.stackingSquare&&(n.stackingSquare=null)},t.prototype.updateText=function(){var e=this.getComponent(cc.Sprite);-1!=this.value?e.spriteFrame=this.spriteList[this.value-1]:e.spriteFrame=this.spriteList[this.spriteList.length-1]},a([u(cc.Label)],t.prototype,"text",void 0),a([u([cc.SpriteFrame])],t.prototype,"spriteList",void 0),a([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"./NumberController":"NumberController","./SquareController":"SquareController"}],SquareController:[function(e,t,o){"use strict";cc._RF.push(t,"c61690bQ7NAkpOP0il93k1R","SquareController");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,o,i):r(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,s=i.ccclass,c=i.property,l=cc.tween,u=e("./NumberController"),p=e("./SquareController"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.linkedSquareList=[],t.linkedSquareNodeList=[],t}var o;return r(t,e),o=t,t.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0;for(var e=0;e<this.linkedSquareNodeList.length;++e)this.linkedSquareList.push(this.linkedSquareNodeList[e].getComponent(p.default));this.index<3?this.row=1:this.index<7?this.row=2:this.index<12?this.row=3:this.index<16?this.row=4:this.index<19&&(this.row=5)},t.prototype.onCollisionEnter=function(e,t){var o=t.getComponent(p.default),n=e.getComponent(u.default);1==e.tag&&(null==o.placedNumber?(o.stackingNumber=n,l(this.node).to(.2,{opacity:20}).start(),-1==n.value&&o.linkedSquareList.forEach(function(e){null!=e.placedNumber&&l(e.placedNumber.node).to(.2,{opacity:20}).start()})):-1==n.value&&(o.stackingNumber=n,l(o.placedNumber.node).to(.2,{opacity:20}).start(),l(o.node).to(.2,{opacity:20}).start(),o.linkedSquareList.forEach(function(e){null!=e.placedNumber&&l(e.placedNumber.node).to(.2,{opacity:20}).start()})))},t.prototype.onCollisionExit=function(e,t){var o=t.getComponent(p.default),n=e.getComponent(u.default);1==e.tag&&o.stackingNumber==n&&(-1!=n.value?(o.stackingNumber=null,l(o.node).to(.2,{opacity:150}).start()):-1==n.value&&(null!=o.placedNumber?l(o.placedNumber.node).to(.2,{opacity:255}).start():l(o.node).to(.2,{opacity:150}).start(),o.linkedSquareList.forEach(function(e){null!=e.placedNumber&&l(e.placedNumber.node).to(.2,{opacity:255}).start()}),o.stackingNumber=o.placedNumber))},a([c([o])],t.prototype,"linkedSquareList",void 0),a([c([cc.Node])],t.prototype,"linkedSquareNodeList",void 0),a([s],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./NumberController":"NumberController","./SquareController":"SquareController"}]},{},["Admob","AdsManager","CanvasController","CombineAnimation","FBInstantManager","FirebaseManager","GameController","GuideController","NumberController","SquareController"]);